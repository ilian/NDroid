#include<list>
#include<string.h>
#include"whitelist.h"
using namespace std;
list<char const*> whitelist;
void init()
{
    whitelist.push_back("/lib/egl/libEGL_emulation.so");
    whitelist.push_back("/lib/egl/libGLES_android.so");
    whitelist.push_back("/lib/egl/libGLESv1_CM_emulation.so");
    whitelist.push_back("/lib/egl/libGLESv2_emulation.so");

    whitelist.push_back("/lib/hw/audio_policy.default.so");
    whitelist.push_back("/lib/hw/audio.primary.default.so");
    whitelist.push_back("/lib/hw/audio.primary.goldfish.so");
    whitelist.push_back("/lib/hw/bluetooth.default.so");
    whitelist.push_back("/lib/hw/camera.goldfish.jpeg.so");
    whitelist.push_back("/lib/hw/camera.goldfish.so");
    whitelist.push_back("/lib/hw/gps.goldfish.so");
    whitelist.push_back("/lib/hw/gralloc.default.so");
    whitelist.push_back("/lib/hw/gralloc.goldfish.so");
    whitelist.push_back("/lib/hw/keystore.default.so");
    whitelist.push_back("/lib/hw/lights.goldfish.so");
    whitelist.push_back("/lib/hw/local_time.default.so");
    whitelist.push_back("/lib/hw/power.default.so");
    whitelist.push_back("/lib/hw/power.goldfish.so");
    whitelist.push_back("/lib/hw/sensors.goldfish.so");

    whitelist.push_back("/lib/crtbegin_so.o");
    whitelist.push_back("/lib/crtend_so.o");
    whitelist.push_back("/lib/interrupter.so");
    whitelist.push_back("/lib/invoke_mock_media_player.so");
    whitelist.push_back("/lib/libandroidfw.so");
    whitelist.push_back("/lib/libandroid_runtime.so");
    whitelist.push_back("/lib/libandroid_servers.so");
    whitelist.push_back("/lib/libandroid.so");
    whitelist.push_back("/lib/libart-compiler.so");
    whitelist.push_back("/lib/libart.so");
    whitelist.push_back("/lib/libasan_preload.so");
    whitelist.push_back("/lib/libaudioeffect_jni.so");
    whitelist.push_back("/lib/libaudioflinger.so");
    whitelist.push_back("/lib/libaudioutils.so");
    whitelist.push_back("/lib/libbcc.sha1.so");
    whitelist.push_back("/lib/libbcc.so");
    whitelist.push_back("/lib/libbcinfo.so");
    whitelist.push_back("/lib/libbinder.so");
    whitelist.push_back("/lib/libbluetooth_jni.so");
    whitelist.push_back("/lib/libbt-hci.so");
    whitelist.push_back("/lib/libbt-utils.so");
    whitelist.push_back("/lib/libart.so");
    whitelist.push_back("/lib/libcamera_client.so");
    whitelist.push_back("/lib/libcamera_metadata.so");
    whitelist.push_back("/lib/libcameraservice.so");
    whitelist.push_back("/lib/libchromium_net.so");
    whitelist.push_back("/lib/libc_malloc_debug_leak.so");
    whitelist.push_back("/lib/libc_malloc_debug_qemu.so");
    whitelist.push_back("/lib/libclcore.bc");
    whitelist.push_back("/lib/libclcore_debug.bc");
    whitelist.push_back("/lib/libcommon_time_client.so");
    whitelist.push_back("/lib/libcompiler_rt.so");
    whitelist.push_back("/lib/libconnectivitymanager.so");
    whitelist.push_back("/lib/libcorkscrew.so");
    whitelist.push_back("/lib/libcrypto.so");
    whitelist.push_back("/lib/libc.so");
    whitelist.push_back("/lib/libctest.so");
    whitelist.push_back("/lib/libcutils.so");
    whitelist.push_back("/lib/libdefcontainer_jni.so");
    whitelist.push_back("/lib/libdiskconfig.so");
    whitelist.push_back("/lib/libdl.so");
    whitelist.push_back("/lib/libdrmframework_jni.so");
    whitelist.push_back("/lib/libdrmframework.so");
    whitelist.push_back("/lib/libdvm.so");
    whitelist.push_back("/lib/libeffects.so");
    whitelist.push_back("/lib/libEGL.so");
    whitelist.push_back("/lib/libETC1.so");
    whitelist.push_back("/lib/libexif.so");
    whitelist.push_back("/lib/libexpat.so");
    whitelist.push_back("/lib/libext2_blkid.so");
    whitelist.push_back("/lib/libext2_com_err.so");
    whitelist.push_back("/lib/libext2_e2p.so");
    whitelist.push_back("/lib/libext2fs.so");
    whitelist.push_back("/lib/libext2_uuid.so");
    whitelist.push_back("/lib/libext4_utils.so");
    whitelist.push_back("/lib/libFFTEm.so");
    whitelist.push_back("/lib/libfilterfw.so");
    whitelist.push_back("/lib/libfilterpack_imageproc.so");
    whitelist.push_back("/lib/libft2.so");
    whitelist.push_back("/lib/libgabi++.so");
    whitelist.push_back("/lib/libgccdemangle.so");
    whitelist.push_back("/lib/libGLES_trace.so");
    whitelist.push_back("/lib/libGLESv1_CM.so");
    whitelist.push_back("/lib/libGLESv1_enc.so");
    whitelist.push_back("/lib/libGLESv2_enc.so");
    whitelist.push_back("/lib/libGLESv2.so");
    whitelist.push_back("/lib/libGLESv3.so");
    whitelist.push_back("/lib/libgui.so");
    whitelist.push_back("/lib/libhardware_legacy.so");
    whitelist.push_back("/lib/libhardware.so");
    whitelist.push_back("/lib/libharfbuzz_ng.so");
    whitelist.push_back("/lib/libhwui.so");
    whitelist.push_back("/lib/libicui18n.so");
    whitelist.push_back("/lib/libicuuc.so");
    whitelist.push_back("/lib/libinputservice.so");
    whitelist.push_back("/lib/libinput.so");
    whitelist.push_back("/lib/libiprouteutil.so");
    whitelist.push_back("/lib/libjavacore.so");
    whitelist.push_back("/lib/libjavacrypto.so");
    whitelist.push_back("/lib/libjhead_jni.so");
    whitelist.push_back("/lib/libjhead.so");
    whitelist.push_back("/lib/libjni_eglfence.so");
    whitelist.push_back("/lib/libjni_filtershow_filters.so");
    whitelist.push_back("/lib/libjnigraphics.so");
    whitelist.push_back("/lib/libjni_jpegstream.so");
    whitelist.push_back("/lib/libjni_latinime.so");
    whitelist.push_back("/lib/libjni_mosaic.so");
    whitelist.push_back("/lib/libjni_pacprocessor.so");
    whitelist.push_back("/lib/libjni_pinyinime.so");
    whitelist.push_back("/lib/libjni_tinyplanet.so");
    whitelist.push_back("/lib/libjpeg.so");
    whitelist.push_back("/lib/libkeystore_binder.so");
    whitelist.push_back("/lib/libLLVM.so");
    whitelist.push_back("/lib/liblog.so");
    whitelist.push_back("/lib/liblogwrap.so");
    whitelist.push_back("/lib/libmdnssd.so");
    whitelist.push_back("/lib/libmedia_jni.so");
    whitelist.push_back("/lib/libmedialogservice.so");
    whitelist.push_back("/lib/libmediaplayerservice.so");
    whitelist.push_back("/lib/libmedia.so");
    whitelist.push_back("/lib/libmemtrack.so");
    whitelist.push_back("/lib/libm.so");
    whitelist.push_back("/lib/libmtp.so");
    whitelist.push_back("/lib/libnativehelper.so");
    whitelist.push_back("/lib/libnbaio.so");
    whitelist.push_back("/lib/libnetlink.so");
    whitelist.push_back("/lib/libnetutils.so");
    whitelist.push_back("/lib/libnfc_ndef.so");
    whitelist.push_back("/lib/libOpenglSystemCommon.so");
    whitelist.push_back("/lib/libOpenMAXAL.so");
    whitelist.push_back("/lib/libOpenSLES.so");
    whitelist.push_back("/lib/libpac.so");
    whitelist.push_back("/lib/libpagemap.so");
    whitelist.push_back("/lib/libpixelflinger.so");
    whitelist.push_back("/lib/libpng.so");
    whitelist.push_back("/lib/libportable.so");
    whitelist.push_back("/lib/libpowermanager.so");
    whitelist.push_back("/lib/libpower.so");
    whitelist.push_back("/lib/libreference-ril.so");
    whitelist.push_back("/lib/lib_renderControl_enc.so");
    whitelist.push_back("/lib/libril.so");
    whitelist.push_back("/lib/librilutils.so");
    whitelist.push_back("/lib/libRScpp.so");
    whitelist.push_back("/lib/libRSCpuRef.so");
    whitelist.push_back("/lib/libRSDriver.so");
    whitelist.push_back("/lib/librs_jni.so");
    whitelist.push_back("/lib/libRS.so");
    whitelist.push_back("/lib/librtp_jni.so");
    whitelist.push_back("/lib/libselinux.so");
    whitelist.push_back("/lib/libsensorservice.so");
    whitelist.push_back("/lib/libskia.so");
    whitelist.push_back("/lib/libsoftkeymaster.so");
    whitelist.push_back("/lib/libsonivox.so");
    whitelist.push_back("/lib/libsoundpool.so");
    whitelist.push_back("/lib/libsparse.so");
    whitelist.push_back("/lib/libspeexresampler.so");
    whitelist.push_back("/lib/libsqlite_jni.so");
    whitelist.push_back("/lib/libsqlite.so");
    whitelist.push_back("/lib/libSR_AudioIn.so");
    whitelist.push_back("/lib/libsrec_jni.so");
    whitelist.push_back("/lib/libssl.so");
    whitelist.push_back("/lib/libstagefright_amrnb_common.so");
    whitelist.push_back("/lib/libstagefright_avc_common.so");
    whitelist.push_back("/lib/libstagefright_chromium_http.so");
    whitelist.push_back("/lib/libstagefright_enc_common.so");
    whitelist.push_back("/lib/libstagefright_foundation.so");
    whitelist.push_back("/lib/libstagefright_httplive.so");
    whitelist.push_back("/lib/libstagefright_omx.so");
    whitelist.push_back("/lib/libstagefright.so");
    whitelist.push_back("/lib/libstagefright_soft_aacdec.so");
    whitelist.push_back("/lib/libstagefright_soft_aacenc.so");
    whitelist.push_back("/lib/libstagefright_soft_amrdec.so");
    whitelist.push_back("/lib/libstagefright_soft_amrnbenc.so");
    whitelist.push_back("/lib/libstagefright_soft_amrwbenc.so");
    whitelist.push_back("/lib/libstagefright_soft_flacenc.so");
    whitelist.push_back("/lib/libstagefright_soft_g711dec.so");
    whitelist.push_back("/lib/libstagefright_soft_gsmdec.so");
    whitelist.push_back("/lib/libstagefright_soft_h264dec.so");
    whitelist.push_back("/lib/libstagefright_soft_h264enc.so");
    whitelist.push_back("/lib/libstagefright_soft_mp3dec.so");
    whitelist.push_back("/lib/libstagefright_soft_mpeg4dec.so");
    whitelist.push_back("/lib/libstagefright_soft_mpeg4enc.so");
    whitelist.push_back("/lib/libstagefright_soft_rawdec.so");
    whitelist.push_back("/lib/libstagefright_soft_vorbisdec.so");
    whitelist.push_back("/lib/libstagefright_soft_vpxdec.so");
    whitelist.push_back("/lib/libstagefright_soft_vpxenc.so");
    whitelist.push_back("/lib/libstagefright_wfd.so");
    whitelist.push_back("/lib/libstagefright_yuv.so");
    whitelist.push_back("/lib/libstdc++.so");
    whitelist.push_back("/lib/libstlport.so");
    whitelist.push_back("/lib/libsurfaceflinger_ddmconnection.so");
    whitelist.push_back("/lib/libsurfaceflinger.so");
    whitelist.push_back("/lib/libsuspend.so");
    whitelist.push_back("/lib/libsync.so");
    whitelist.push_back("/lib/libsysutils.so");
    whitelist.push_back("/lib/libthread_db.so");
    whitelist.push_back("/lib/libtinyalsa.so");
    whitelist.push_back("/lib/libttscompat.so");
    whitelist.push_back("/lib/libttspico.so");
    whitelist.push_back("/lib/libui.so");
    whitelist.push_back("/lib/libusbhost.so");
    whitelist.push_back("/lib/libutils.so");
    whitelist.push_back("/lib/libvariablespeed.so");
    whitelist.push_back("/lib/libvideoeditor_core.so");
    whitelist.push_back("/lib/libvideoeditor_jni.so");
    whitelist.push_back("/lib/libvideoeditor_osal.so");
    whitelist.push_back("/lib/libvideoeditorplayer.so");
    whitelist.push_back("/lib/libvideoeditor_videofilters.so");
    whitelist.push_back("/lib/libvorbisidec.so");
    whitelist.push_back("/lib/libwebrtc_audio_preprocessing.so");
    whitelist.push_back("/lib/libwebviewchromium_plat_support.so");
    whitelist.push_back("/lib/libwebviewchromium.so");
    whitelist.push_back("/lib/libwilhelm.so");
    whitelist.push_back("/lib/libwnndict.so");
    whitelist.push_back("/lib/libWnnEngDic.so");
    whitelist.push_back("/lib/libWnnJpnDic.so");
    whitelist.push_back("/lib/libwpa_client.so");
    whitelist.push_back("/lib/libz.so");

    whitelist.push_back("/lib/soundfx/libaudiopreprocessing.so");
    whitelist.push_back("/lib/soundfx/libbundlewrapper.so");
    whitelist.push_back("/lib/soundfx/libdownmix.so");
    whitelist.push_back("/lib/soundfx/libeffectproxy.so");
    whitelist.push_back("/lib/soundfx/libldnhncr.so");
    whitelist.push_back("/lib/soundfx/libreverbwrapper.so");
    whitelist.push_back("/lib/soundfx/libvisualizer.so");

    whitelist.push_back("/lib/ssl/engines/libkeystore.so");

    whitelist.push_back("/lib/drm/libfwdlockengine.so");
}

void clean(){
    whitelist.clear();
}

bool isInList(char * name){
    list<char const*>::iterator it;
    for (it=whitelist.begin();it!=whitelist.end();++it) {
        if(strcmp(*it,name)==0)
            return 1;
    }
    return 0;
}
